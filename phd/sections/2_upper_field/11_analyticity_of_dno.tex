\section{Analyticity of the Upper Layer DNO}
\label{intro:analyticity of dno}

Now that we have established the analyticity of the transformed field, $u=u(x,z;\varepsilon,\delta)$, we move on to establishing the analyticity of the DNO, $G(g)=G(\varepsilon f)$. The Dirichlet trace is defined by
$$\zeta^u(x) := u(x,g(x)),$$
and its exterior Neumann counterpart is defined as
\begin{equation}\nu^u(x) := [-N\cdot \nabla u](x,g(x)) = [-\partial_z u + (\partial_x g) \partial_x u](x,g(x)),\end{equation}
where $N=(-\partial_x g,1)^T$. With this we define the DNO
\begin{equation} G(g):= \zeta^u \to \nu^u,\end{equation}
which maps the Dirichlet data, $\zeta^u$, to the Neumann trace, $\nu^u$,
\begin{equation}G(g)[\zeta^u]= [-\partial_z u + (\partial_x g) \partial_x u](x,g(x)).\end{equation}
We now analyze how the operator $G(g)$ behaves under the change of variables in Appendix $C$. To do this, we multiply $(2.49)$ by $C(x)$ to realize
$$CG = -C\partial_z u + (\partial_x g) C\partial_x u.$$
The differentiation rules for the change of variables, $(\text{C}.5)$,
$$C\partial_x = C\partial_{x'}-E\partial_{z'},\quad C\partial_z = \partial_{z'},$$
produces
$$CG = -\partial_{z'}u'+(\partial_{x'} g)\{C\partial_{x'} u' - E\partial_{z'} u'\}.$$
These are evaluated at the lower boundary, $z'=0$, where we observe that
$$C(x')=1-\frac{g}{a},\quad E(x',0)=\partial_{x'}g,$$
to find

$$\left(1-\frac{g}{a}\right)G=-\partial_{z'}u' +(\partial_{x'} g)\left\{\left(1-\frac{g}{a}\right)\partial_{x'} u' - (\partial_{x'}g)\partial_{z'} u' \right\}.$$
We solve for $G$ and drop the primes to find
\begin{equation}G(g)[\zeta^u] = -\partial_z u(x,0) + H(x;g,u),\end{equation}
with
\begin{align}
\begin{split}
H(x;g,u):=&~ (\partial_xg)\partial_x u(x,0)+\frac{1}{a}gG(g)[\zeta^u]\\&  - \frac{1}{a}g(\partial_x g)\partial_x u(x,0)  -(\partial_x g)^2\partial_z u(x,0). 
\end{split}
\end{align}
Upon setting $g(x)=\varepsilon f(x)$ and seeking an expansion of the form
$$G=G(\varepsilon f,\delta)=\sum_{n=0}^{\infty}\sum_{m=0}^{\infty}G_{n,m}(f)\varepsilon^n\delta^m,$$
the equations $(2.50)$ and $(2.51)$ deliver
\begin{equation}G_{n,m}(f)[\zeta^u]=-\partial_z u_{n,m}(x,0)+ H_{n,m}(x;f,u),\end{equation}
by which
\begin{align}
\begin{split}
H_{n,m}(x;f,u):=&~ (\partial_xf)\partial_x u_{n-1,m}(x,0)+\frac{1}{a}fG_{n-1,m}(f)[\zeta^u]\\&  - \frac{1}{a}f(\partial_x f)\partial_x u_{n-2,m}(x,0)  -(\partial_x f)^2\partial_z u_{n-2,m}(x,0). 
\end{split}
\end{align}
To prove the analyticity of the DNO we will need the following recursive estimate for $H_{n,m}$.
\vskip 0.1in
\begin{lemma} Given an integer $s\ge 0$, if $f\in C^{s+2}([0,d])$ and
\begin{equation}\|u_{n,m}\|_{H^{s+2}} \le KB^{n}D^{m}, \quad \|G_{n,m}\|_{H^{s+1/2}}\le \tilde{K}\tilde{B}^{n}\tilde{D}^{m},\quad \forall~ n < \overline{n},~m\ge 0,\end{equation}
for constants $K,B,D,\tilde{K},\tilde{B},\tilde{D} > 0$ where $\tilde{K}\ge K,\tilde{B}\ge B, \tilde{D}\ge D$, then there exists a constant $\tilde{C} > 0$ such that
\begin{equation}\|H_{\overline{n},m}\|_{H^{s+1/2}} \le \tilde{K}\tilde{C}\left\{|f|_{C^{s+2}}\tilde{B}^{n-1}\tilde{D}^{m}+ |f|_{C^{s+2}}^2\tilde{B}^{n-2}\tilde{D}^{m}\right\}.\end{equation}
\end{lemma}
\vskip 0.1in
\begin{proof}{[Lemma 2.10.1]} From ($2.53$) and Lemma $2.7.1$ we estimate
\begin{align*}\|H_{\overline{n},m}\|_{H^{s+1/2}}&\le \mathcal{M}|\partial_x f|_{C^{s+1/2+\sigma}}\|\partial_x u_{\overline{n}-1,m}(x,0)\|_{H^{s+1/2}}\\&
+\frac{1}{a}\mathcal{M}|f|_{C^{s+1/2+\sigma}}\|G_{\overline{n}-1,m}(f)[\zeta^u]\|_{H^{s+1/2}}\\&
+\frac{1}{a}\mathcal{M}^2|f|_{C^{s+1/2+\sigma}}|\partial_x f|_{C^{s+1/2+\sigma}}\|\partial_x u_{\overline{n}-2,m}(x,0)\|_{H^{s+1/2}}\\&
+\mathcal{M}^2|\partial_x f|^2_{C^{s+1/2+\sigma}}\|\partial_z u_{\overline{n}-2,m}(x,0)\|_{H^{s+1/2}}.
\end{align*}
This gives
\begin{align*}\|H_{\overline{n},m}\|_{H^{s+1/2}}&\le \tilde{K}\Big\{\mathcal{M}| f|_{C^{s+2}}\tilde{B}^{\overline{n}-1}\tilde{D}^{m} + \frac{1}{a}\mathcal{M}|f|_{C^{s+2}}\tilde{B}^{\overline{n}-1}\tilde{D}^{m} \\&~~~~~~~~+
\frac{1}{a}\mathcal{M}^2|f|_{C^{s+2}}^2\tilde{B}^{\overline{n}-2}\tilde{D}^{m} + \mathcal{M}^2|f|_{C^{s+2}}^2\tilde{B}^{\overline{n}-2}\tilde{D}^{m}\Big\},
\end{align*}
and we are done provided
$$\tilde{C} \ge \left(1+\frac{1}{a}\right)\max\{\mathcal{M},\mathcal{M}^2\}.$$
\end{proof}
\begin{flushleft}
We now have everything we need to prove the analyticity of the upper layer DNO.
\end{flushleft}
\vskip 0.1in
\begin{theorem} Given any integer $s\ge 0$, if $f\in C^{s+2}([0,d])$ and $\zeta^u_{n,m}\in H^{s+3/2}([0,d])$ such that
$$\|\zeta^u_{n,m}\|_{H^{s+3/2}} \le K_{\zeta}B_{\zeta}^nD_{\zeta}^m, $$
for constants $K_{\zeta},B_{\zeta},D_{\zeta} > 0$, then $G_{n,m}\in H^{s+1/2}([0,d])$ and
\begin{equation} \|G_{n,m}\|_{H^{s+1/2}} \le \tilde{K}\tilde{B}^{n}\tilde{D}^{m},\end{equation}
for constants $\tilde{K},\tilde{B},\tilde{D} > 0$.
\end{theorem}
\vskip 0.1in
\begin{proof}{[Theorem 2.10.2]} As before, we work by induction in $n$. At $n=0$ we have from $(2.52)$ that
$$G_{0,m}=-\partial_z u_{0,m}(x,0),$$
and from Theorem $2.9.2$ we have
$$\|G_{0,m}\|_{H^{s+1/2}} = \|\partial_z u_{0,m}(x,0)\|_{H^{s+1/2}}\le  \|u_{0,m}\|_{H^{s+2}} \le KD^m.$$
So we choose $\tilde{K} \ge K$ and $\tilde{D} \ge D$. We now assume $\tilde{B} \ge B$ and the estimate $(2.56)$ for all $n < \overline{n}$ and estimate $(2.52)$
$$\|G_{\overline{n},m}(f)[\zeta^u]\|_{H^{s+1/2}}\le \|\partial_z u_{\overline{n},m}(x,0)\|_{H^{s+1/2}}+ \|H_{\overline{n},m}(x)\|_{H^{s+1/2}}.$$
Using the inductive hypothesis, Lemma $2.10.1$, and Theorem $2.9.2$ we have
$$\|G_{\overline{n},m}(f)[\zeta^u]\|_{H^{s+1/2}}\le KB^{\overline{n}}D^m + \tilde{K}\tilde{C}\left\{|f|_{C^{s+2}}\tilde{B}^{\overline{n}-1}\tilde{D}^{m}+ |f|_{C^{s+2}}^2\tilde{B}^{\overline{n}-2}\tilde{D}^{m}\right\}.$$
We are done provided $\tilde{K} \ge 2K$ and
\bes
\tilde{B} \ge \max\left\{B,4\tilde{C}|f|_{C^{s+2}},2\sqrt{\tilde{C}} |f|_{C^{s+2}}\right\}.\qedhere
\ees
\end{proof}